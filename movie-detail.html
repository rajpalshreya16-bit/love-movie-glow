<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Movie Detail - Lovify</title>
    <meta name="description" content="Discover the perfect romantic movie with detailed information, songs, and more.">
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Inter:wght@300;400;500;600&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="styles.css">
    <style>
        .movie-detail-hero {
            min-height: 70vh;
            background-size: cover;
            background-position: center;
            position: relative;
            display: flex;
            align-items: flex-end;
        }
        
        .movie-detail-overlay {
            position: absolute;
            inset: 0;
            background: linear-gradient(to top, rgba(0,0,0,0.9), rgba(0,0,0,0.3));
        }
        
        .movie-detail-content {
            position: relative;
            z-index: 10;
            padding: 2rem;
            width: 100%;
        }
        
        .movie-detail-info {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .movie-detail-title {
            font-family: 'Playfair Display', serif;
            font-size: 3rem;
            font-weight: 700;
            color: white;
            margin-bottom: 1rem;
        }
        
        .movie-detail-meta {
            display: flex;
            gap: 2rem;
            margin-bottom: 1.5rem;
            flex-wrap: wrap;
        }
        
        .movie-detail-year,
        .movie-detail-rating,
        .movie-detail-genre {
            color: rgba(255,255,255,0.8);
            font-size: 1.1rem;
        }
        
        .movie-detail-description {
            font-size: 1.2rem;
            color: rgba(255,255,255,0.9);
            line-height: 1.6;
            margin-bottom: 2rem;
        }
        
        .movie-detail-actions {
            display: flex;
            gap: 1rem;
            flex-wrap: wrap;
        }
        
        .songs-section {
            padding: 4rem 0;
            background: var(--secondary);
        }
        
        .songs-grid {
            display: grid;
            gap: 1rem;
            max-width: 800px;
            margin: 0 auto;
        }
        
        .song-card {
            background: var(--card);
            border: 1px solid var(--border);
            border-radius: var(--radius);
            padding: 1.5rem;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .song-info h4 {
            color: var(--foreground);
            margin-bottom: 0.25rem;
        }
        
        .song-info p {
            color: var(--muted-foreground);
            font-size: 0.9rem;
        }
        
        .spotify-btn {
            background: #1DB954;
            color: white;
            padding: 0.5rem 1rem;
            border-radius: var(--radius);
            text-decoration: none;
            font-weight: 500;
            transition: all 0.3s ease;
        }
        
        .spotify-btn:hover {
            background: #1ed760;
            transform: translateY(-1px);
        }
        
        .back-btn {
            position: fixed;
            top: 6rem;
            left: 2rem;
            background: rgba(15, 23, 42, 0.8);
            border: 1px solid var(--border);
            color: var(--foreground);
            padding: 0.75rem;
            border-radius: var(--radius);
            cursor: pointer;
            transition: all 0.3s ease;
            backdrop-filter: blur(10px);
            z-index: 50;
        }
        
        .back-btn:hover {
            background: var(--primary);
        }
    </style>
</head>
<body>
    <div id="app">
        <!-- Back Button -->
        <button class="back-btn" onclick="window.history.back()">
            <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                <path d="M19 12H5M12 19l-7-7 7-7"/>
            </svg>
        </button>

        <!-- Movie Detail Hero -->
        <section class="movie-detail-hero" id="movie-hero">
            <div class="movie-detail-overlay"></div>
            <div class="movie-detail-content">
                <div class="movie-detail-info">
                    <h1 class="movie-detail-title" id="movie-title">Loading...</h1>
                    <div class="movie-detail-meta">
                        <span class="movie-detail-year" id="movie-year"></span>
                        <span class="movie-detail-rating" id="movie-rating"></span>
                        <span class="movie-detail-genre" id="movie-genre"></span>
                    </div>
                    <p class="movie-detail-description" id="movie-description"></p>
                    <div class="movie-detail-actions">
                        <button class="btn btn-primary" onclick="toggleLike()" id="like-btn">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                            </svg>
                            Add to Favorites
                        </button>
                        <button class="btn btn-outline" onclick="shareMovie()">
                            <svg class="btn-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                                <path d="M4 12v8a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2v-8"></path>
                                <polyline points="16,6 12,2 8,6"></polyline>
                                <line x1="12" y1="2" x2="12" y2="15"></line>
                            </svg>
                            Share Movie
                        </button>
                    </div>
                </div>
            </div>
        </section>

        <!-- Songs Section -->
        <section class="songs-section" id="songs-section" style="display: none;">
            <div class="container">
                <div class="section-header">
                    <h2 class="section-title">Soundtrack</h2>
                    <p class="section-description">
                        The beautiful songs that make this movie unforgettable.
                    </p>
                </div>
                <div class="songs-grid" id="songs-grid">
                    <!-- Songs will be populated by JavaScript -->
                </div>
            </div>
        </section>

        <!-- Footer -->
        <footer class="footer">
            <div class="container">
                <div class="footer-content">
                    <div class="footer-brand">
                        <svg class="footer-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor">
                            <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
                        </svg>
                        <span class="footer-title">Lovify</span>
                    </div>
                    <p class="footer-text">
                        Discovering love stories, one movie at a time.
                    </p>
                </div>
            </div>
        </footer>
    </div>

    <!-- Toast Notification -->
    <div id="toast" class="toast">
        <div class="toast-content">
            <div class="toast-title" id="toast-title"></div>
            <div class="toast-description" id="toast-description"></div>
        </div>
    </div>

    <script src="movies.js"></script>
    <script>
        // Global variables
        let currentMovie = null;
        let likedMovies = new Set();

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            const urlParams = new URLSearchParams(window.location.search);
            const movieId = parseInt(urlParams.get('id'));
            
            if (movieId) {
                loadMovieDetail(movieId);
            } else {
                window.location.href = '404.html';
            }
        });

        // Load movie details
        function loadMovieDetail(movieId) {
            currentMovie = window.moviesData.find(m => m.id === movieId);
            
            if (!currentMovie) {
                window.location.href = '404.html';
                return;
            }

            // Update page title
            document.title = `${currentMovie.title} - Lovify`;

            // Update hero section
            const heroSection = document.getElementById('movie-hero');
            heroSection.style.backgroundImage = `url('${currentMovie.poster}')`;

            // Update movie info
            document.getElementById('movie-title').textContent = currentMovie.title;
            document.getElementById('movie-year').textContent = currentMovie.year;
            document.getElementById('movie-rating').textContent = `★ ${currentMovie.rating}`;
            document.getElementById('movie-genre').textContent = currentMovie.genre;
            document.getElementById('movie-description').textContent = currentMovie.description;

            // Update like button
            updateLikeButton();

            // Load songs if available
            if (currentMovie.songs && currentMovie.songs.length > 0) {
                loadSongs();
            }
        }

        // Load songs
        function loadSongs() {
            const songsSection = document.getElementById('songs-section');
            const songsGrid = document.getElementById('songs-grid');
            
            songsSection.style.display = 'block';
            
            songsGrid.innerHTML = currentMovie.songs.map(song => `
                <div class="song-card">
                    <div class="song-info">
                        <h4>${song.title}</h4>
                        <p>by ${song.artist}</p>
                    </div>
                    ${song.spotifyUrl ? `<a href="${song.spotifyUrl}" target="_blank" class="spotify-btn">Listen on Spotify</a>` : ''}
                </div>
            `).join('');
        }

        // Toggle like
        function toggleLike() {
            if (!currentMovie) return;
            
            if (likedMovies.has(currentMovie.id)) {
                likedMovies.delete(currentMovie.id);
                showToast("Removed from favorites", "Movie removed from your list");
            } else {
                likedMovies.add(currentMovie.id);
                showToast("Added to favorites ♡", "Movie saved to your collection");
            }
            
            updateLikeButton();
        }

        // Update like button
        function updateLikeButton() {
            if (!currentMovie) return;
            
            const likeBtn = document.getElementById('like-btn');
            const heartIcon = likeBtn.querySelector('svg path');
            
            if (likedMovies.has(currentMovie.id)) {
                likeBtn.textContent = 'Remove from Favorites';
                likeBtn.prepend(likeBtn.querySelector('svg'));
                heartIcon.setAttribute('fill', 'currentColor');
            } else {
                likeBtn.textContent = 'Add to Favorites';
                likeBtn.prepend(likeBtn.querySelector('svg'));
                heartIcon.setAttribute('fill', 'none');
            }
        }

        // Share movie
        function shareMovie() {
            if (!currentMovie) return;
            
            const shareText = `Check out ${currentMovie.title} (${currentMovie.year}) on Lovify - ${currentMovie.description}`;
            
            if (navigator.share) {
                navigator.share({
                    title: `Check out ${currentMovie.title}!`,
                    text: `I found this amazing romantic movie on Lovify: ${currentMovie.title} (${currentMovie.year}). ${currentMovie.description}`,
                    url: window.location.href,
                });
            } else {
                navigator.clipboard.writeText(shareText).then(() => {
                    showToast("Link copied! ✨", "Share this movie with your friends");
                });
            }
        }

        // Toast notification
        function showToast(title, description) {
            const toast = document.getElementById('toast');
            const toastTitle = document.getElementById('toast-title');
            const toastDescription = document.getElementById('toast-description');
            
            toastTitle.textContent = title;
            toastDescription.textContent = description;
            
            toast.classList.add('show');
            
            setTimeout(() => {
                toast.classList.remove('show');
            }, 3000);
        }
    </script>
</body>
</html>